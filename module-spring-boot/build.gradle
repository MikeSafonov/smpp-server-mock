sourceSets {
    testIntegration {
        java {
            compileClasspath += sourceSets.main.output
            runtimeClasspath += sourceSets.main.output
            srcDir file('src/testIntegration/java')
        }
    }
}

configurations {
    testIntegrationImplementation.extendsFrom implementation, testImplementation
    testIntegrationRuntime.extendsFrom runtimeOnly
}

dependencies {
    implementation platform("org.springframework.cloud:spring-cloud-dependencies:Hoxton.SR10")
    implementation platform("org.springframework.boot:spring-boot-dependencies:2.4.4")
    annotationProcessor platform("org.springframework.boot:spring-boot-dependencies:2.4.3")

    compileOnly("org.springframework.boot:spring-boot-configuration-processor")
    annotationProcessor("org.springframework.boot:spring-boot-configuration-processor")

    compileOnly("org.springframework.cloud:spring-cloud-starter")

    api(project(":module-core"))

    testImplementation("org.springframework.boot:spring-boot-starter-test:2.5.6")

    testIntegrationImplementation 'org.awaitility:awaitility:4.1.0'
    testIntegrationImplementation("org.springframework.cloud:spring-cloud-starter")
    testIntegrationImplementation("com.github.mikesafonov:spring-boot-starter-smpp:1.0.0")
}


task testIntegration(type: Test){
    useJUnitPlatform()
    testClassesDirs = sourceSets.testIntegration.output.classesDirs
    classpath = sourceSets.testIntegration.runtimeClasspath
}
